# ğŸš‚ ERA API - AKIÅ DÄ°YAGRAMLARI VE DETAYLI DOKÃœMANTASYON

**Son GÃ¼ncelleme:** 24 Ocak 2026
**Kaynak:** Rail Europe ERA API Resmi DokÃ¼mantasyonu

---

## ğŸ“Š 1. ANA BOOKING AKIÅI (Temel)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              BOOKING FLOW                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                   â”‚
â”‚  â”‚ SEARCH FOR P2P/PASS  â”‚         Status: -                                 â”‚
â”‚  â”‚       OFFERS         â”‚                                                   â”‚
â”‚  â”‚ POST /offers/{type}/ â”‚                                                   â”‚
â”‚  â”‚      searches        â”‚                                                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                   â”‚
â”‚             â”‚                                                                â”‚
â”‚             â–¼                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                   â”‚
â”‚  â”‚   CREATE BOOKING     â”‚         Status: CREATED                           â”‚
â”‚  â”‚   POST /bookings     â”‚                                                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                   â”‚
â”‚             â”‚                                                                â”‚
â”‚             â–¼                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                   â”‚
â”‚  â”‚ UPDATE TRAVELERS     â”‚         Status: CREATED                           â”‚
â”‚  â”‚      DETAILS         â”‚                                                   â”‚
â”‚  â”‚ PUT /bookings/{id}/  â”‚                                                   â”‚
â”‚  â”‚ items/{itemId}/      â”‚                                                   â”‚
â”‚  â”‚     travelers        â”‚                                                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                   â”‚
â”‚             â”‚                                                                â”‚
â”‚             â–¼                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                   â”‚
â”‚  â”‚  PREBOOK THE BOOKING â”‚         Status: PREBOOKED                         â”‚
â”‚  â”‚ POST /bookings/{id}/ â”‚                                                   â”‚
â”‚  â”‚   checkout/prebook   â”‚                                                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                   â”‚
â”‚             â”‚                                                                â”‚
â”‚             â–¼                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                   â”‚
â”‚  â”‚   CONFIRM BOOKING    â”‚         Status: INVOICED                          â”‚
â”‚  â”‚ POST /bookings/{id}/ â”‚                                                   â”‚
â”‚  â”‚   checkout/confirm   â”‚                                                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                   â”‚
â”‚             â”‚                                                                â”‚
â”‚             â–¼                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                   â”‚
â”‚  â”‚   RETRIEVE TICKET    â”‚         Status: INVOICED                          â”‚
â”‚  â”‚ POST /bookings/{id}/ â”‚                                                   â”‚
â”‚  â”‚       print          â”‚                                                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                   â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Booking Status GeÃ§iÅŸleri
| AdÄ±m | API Endpoint | Ã–nceki Status | Sonraki Status |
|------|--------------|---------------|----------------|
| 1. Search | `POST /offers/point-to-point/searches` | - | - |
| 2. Create | `POST /bookings` | - | **CREATED** |
| 3. Travelers | `PUT /bookings/{id}/items/{itemId}/travelers` | CREATED | **CREATED** |
| 4. Prebook | `POST /bookings/{id}/checkout/prebook` | CREATED | **PREBOOKED** |
| 5. Confirm | `POST /bookings/{id}/checkout/confirm` | PREBOOKED | **INVOICED** |
| 6. Print | `POST /bookings/{id}/print` | INVOICED | **INVOICED** |

---

## ğŸ“Š 2. DETAYLI BOOKING AKIÅI (TÃ¼m Opsiyonlar)

```
Search Offers
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Create    â”‚â”€â”€â”€â–¶â”‚  Update travelers   â”‚â”€â”€â”€â–¶â”‚   (optional)    â”‚
â”‚   booking   â”‚    â”‚      details        â”‚    â”‚  Update agency  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚                     â”‚    â”‚     details     â”‚
                   â”‚  â—† for each         â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚    booking item     â”‚             â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â–¼
                                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                              â”‚   (optional)    â”‚
                                              â”‚ Update services â”‚
                                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                       â”‚
                                                       â–¼
                                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                              â”‚    Prebook      â”‚
                                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                       â”‚
                                                       â–¼
                                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                              â”‚   (optional)    â”‚
                                              â”‚  Claim billing  â”‚
                                              â”‚      docs       â”‚
                                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                       â”‚
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚                                                    â”‚
                              â–¼                                                    â–¼
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚ Confirm booking â”‚                              â”‚   (optional)    â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚  Hold booking   â”‚
                              â”‚                                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â–¼
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚  Print booking  â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š 3. AUTHENTICATION AKIÅI

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  API Client â”‚         â”‚ Auth Server â”‚         â”‚API Endpoint â”‚
â”‚    </>      â”‚         â”‚     ğŸ”      â”‚         â”‚    <->      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚                       â”‚                       â”‚
       â”‚ Authentication requestâ”‚                       â”‚
       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                       â”‚
       â”‚                       â”‚                       â”‚
       â”‚ Access Token X1 issuedâ”‚                       â”‚
       â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                       â”‚
       â”‚                       â”‚                       â”‚
       â”‚                       â”‚                       â”‚
   â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”
   â”‚                      60 mins                           â”‚
   â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜
       â”‚                       â”‚                       â”‚
       â”‚ API call #1 with Token X1                     â”‚
       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
       â”‚                       â”‚          API response â”‚
       â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
       â”‚                       â”‚                       â”‚
       â”‚ API call #2 with Token X1                     â”‚
       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
       â”‚                       â”‚          API response â”‚
       â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
       â”‚                       â”‚                       â”‚
   â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•
       â”‚ Token expires (60 min)â”‚                       â”‚
   â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•
       â”‚                       â”‚                       â”‚
       â”‚ Authentication requestâ”‚                       â”‚
       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                       â”‚
       â”‚                       â”‚                       â”‚
       â”‚ Access Token X2 issuedâ”‚                       â”‚
       â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                       â”‚
       â”‚                       â”‚                       â”‚
   â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”
   â”‚                      60 mins                           â”‚
   â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜
       â”‚                       â”‚                       â”‚
       â”‚ API call #3 with Token X2                     â”‚
       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
       â”‚                       â”‚          API response â”‚
       â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
```

### Token YÃ¶netimi KurallarÄ±
- â±ï¸ Token sÃ¼resi: **60 dakika**
- ğŸ”„ Token expire olmadan Ã¶nce yenile
- ğŸ’¾ Token'Ä± cache'le, her istekte yeniden alma
- âš ï¸ 401 hatasÄ± alÄ±rsan token'Ä± yenile

---

## ğŸ“Š 4. SEQUENCE DÄ°YAGRAMI (Tam AkÄ±ÅŸ)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   API   â”‚          â”‚  Point to Point   â”‚    â”‚ Bookings â”‚     Booking
â”‚  Client â”‚          â”‚      Offers       â”‚    â”‚          â”‚     Status
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚                         â”‚                   â”‚
     â”‚ POST /offers/point-to-point/searches        â”‚
     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                   â”‚          Searching
     â”‚                         â”‚                   â”‚          for Offers
     â”‚    returns search results                   â”‚
     â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                   â”‚
     â”‚                         â”‚                   â”‚
     â”‚                         â”‚                   â”‚
     â”‚ POST /bookings          â”‚                   â”‚          Creating
     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶          Booking
     â”‚                         â”‚                   â”‚
     â”‚    returns ${BookingId} â”‚                   â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€          â”‚ CREATED â”‚
     â”‚                         â”‚                   â”‚          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚                         â”‚                   â”‚               â”‚
     â”‚ PUT /bookings/${BookingId}/items/${itemId}/travelers       â”‚
     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  Adding      â”‚
     â”‚                         â”‚                   â”‚  Passenger   â”‚
     â”‚    returns ${BookingId} â”‚                   â”‚  Details     â”‚
     â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€               â”‚
     â”‚                         â”‚                   â”‚               â”‚
     â”‚ POST /bookings/${BookingId}/checkout/prebookâ”‚               â”‚
     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  Prebooking  â”‚
     â”‚                         â”‚                   â”‚  Attempt     â–¼
     â”‚    returns ${BookingId} â”‚                   â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€          â”‚PREBOOKED â”‚
     â”‚                         â”‚                   â”‚          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚                         â”‚                   â”‚               â”‚
     â”‚ POST /bookings/${BookingId}/checkout/confirmâ”‚               â”‚
     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  Confirming  â”‚
     â”‚                         â”‚                   â”‚  Booking     â–¼
     â”‚    returns ${BookingId} â”‚                   â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€          â”‚CONFIRMED â”‚
     â”‚                         â”‚                   â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š 5. Ã‡OKLU OFFER BOOKING (GidiÅŸ-DÃ¶nÃ¼ÅŸ veya Ã‡oklu Sefer)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SEARCH FOR P2P/PASS    â”‚         â”‚ SEARCH FOR P2P/PASS    â”‚
â”‚     OFFERS #1          â”‚         â”‚     OFFERS #2          â”‚
â”‚ POST /offers/{type}/   â”‚         â”‚ POST /offers/{type}/   â”‚
â”‚       searches         â”‚         â”‚       searches         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                                  â”‚
            â–¼                                  â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ Selected  â”‚                      â”‚ Selected  â”‚
      â”‚  Offer    â”‚         +            â”‚  Offer    â”‚
      â”‚ Location  â”‚                      â”‚ Location  â”‚
      â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                      â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
            â”‚                                  â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ CREATE BOOKING - ADD ALL     â”‚
            â”‚    SELECTED OFFERS           â”‚
            â”‚      POST /bookings          â”‚
            â”‚                              â”‚
            â”‚  Body: {                     â”‚
            â”‚    items: [                  â”‚
            â”‚      { offerLocations: [...] â”‚  â—€â”€â”€ Offer #1
            â”‚      },                      â”‚
            â”‚      { offerLocations: [...] â”‚  â—€â”€â”€ Offer #2
            â”‚      }                       â”‚
            â”‚    ]                         â”‚
            â”‚  }                           â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚    UPDATE TRAVELERS DETAILS  â”‚    Call this once for
            â”‚ PUT /bookings/{bookingId}/   â”‚â—€â”€â”€ every basket item
            â”‚   items/{itemId}/travelers   â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚     PREBOOK THE BOOKING      â”‚
            â”‚ POST /bookings/{bookingId}/  â”‚
            â”‚       checkout/prebook       â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
                          ...
```

### Ã‡oklu Offer KurallarÄ±
- ğŸ« GidiÅŸ-dÃ¶nÃ¼ÅŸ: 2 ayrÄ± search, 2 offer location
- ğŸ‘¥ Her item iÃ§in ayrÄ± traveler update gerekli
- ğŸ“¦ Tek booking'de birden fazla sefer birleÅŸtirilebilir

---

## ğŸ“Š 6. BOOKING ITEM SÄ°LME AKIÅI

```
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚        RETRIEVE BOOKING          â”‚
            â”‚  Booking must be in CREATED or   â”‚
            â”‚       PREBOOKED status           â”‚
            â”‚    GET /bookings/{bookingId}     â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚      DELETE A BOOKING ITEM       â”‚
            â”‚ DELETE /bookings/{bookingId}/    â”‚
            â”‚        items/{itemId}            â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Booking in   â”‚
                    â”‚   CREATED /   â”‚â”€â”€â”€â”€â”€â”€ No â”€â”€â”€â”€â–¶ âŒ Operation
                    â”‚  PREBOOKED    â”‚                  will fail
                    â”‚      ?        â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                           Yes
                            â”‚
                            â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚Will operation â”‚
                    â”‚ result in at  â”‚â”€â”€â”€â”€â”€â”€ No â”€â”€â”€â”€â–¶ âŒ Operation
                    â”‚  least one    â”‚                  will fail
                    â”‚item in bookingâ”‚
                    â”‚      ?        â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                           Yes
                            â”‚
                            â–¼
                   âœ… Proceed with deletion
```

### Silme KurallarÄ±
- âš ï¸ Sadece **CREATED** veya **PREBOOKED** durumunda silinebilir
- âš ï¸ En az 1 item kalmalÄ± (boÅŸ booking olamaz)
- âŒ INVOICED durumunda silme yapÄ±lamaz

---

## ğŸ“Š 7. Ä°ADE (REFUND) AKIÅI

```
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ booking â”‚
    â”‚invoiced â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
         â”‚
         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚     Refund     â”‚â”€â”€â”€â”€â–¶â”‚      Refund       â”‚
    â”‚   quotation    â”‚     â”‚   confirmation    â”‚
    â”‚                â”‚     â”‚                   â”‚
    â”‚ POST /bookings/â”‚     â”‚ POST /bookings/   â”‚
    â”‚ {id}/refunds/  â”‚     â”‚ {id}/refunds/     â”‚
    â”‚   quotation    â”‚     â”‚    confirm        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â–¼
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚  no more items â”‚
                            â”‚  to refund?    â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚               â”‚               â”‚
                   Yes              â”‚              No
                    â”‚               â”‚               â”‚
                    â–¼               â”‚               â–¼
             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
             â”‚  booking  â”‚         â”‚        â”‚   booking   â”‚
             â”‚ refunded  â”‚         â”‚        â”‚  partially  â”‚
             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚        â”‚  refunded   â”‚
                                   â”‚        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚               â”‚
                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
                                    (loop back)
```

### Ä°ade KurallarÄ±
- ğŸ“‹ Ã–nce **quotation** (fiyat teklifi) al
- âœ… Sonra **confirm** (onay) ile iade tamamla
- ğŸ”„ KÄ±smi iade yapÄ±labilir
- ğŸ’° Ä°ade tutarÄ± quotation'da belirtilir

---

## ğŸ“Š 8. DEÄÄ°ÅÄ°KLÄ°K (EXCHANGE) AKIÅI

```
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ booking â”‚
    â”‚invoiced â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Search      â”‚â”€â”€â”€â”€â–¶â”‚    Exchange     â”‚â”€â”€â”€â”€â–¶â”‚    Exchange     â”‚
â”‚    exchange     â”‚     â”‚   quotation     â”‚     â”‚  confirmation   â”‚
â”‚     offers      â”‚     â”‚                 â”‚     â”‚                 â”‚
â”‚                 â”‚     â”‚ POST /bookings/ â”‚     â”‚ POST /bookings/ â”‚
â”‚ POST /bookings/ â”‚     â”‚ {id}/exchanges/ â”‚     â”‚ {id}/exchanges/ â”‚
â”‚ {id}/exchanges/ â”‚     â”‚   quotation     â”‚     â”‚    confirm      â”‚
â”‚    search       â”‚     â”‚                 â”‚     â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### DeÄŸiÅŸiklik KurallarÄ±
- ğŸ” Ã–nce yeni sefer iÃ§in **search** yap
- ğŸ“‹ **Quotation** ile fiyat farkÄ±nÄ± Ã¶ÄŸren
- âœ… **Confirm** ile deÄŸiÅŸikliÄŸi onayla
- ğŸ’° Fiyat farkÄ± Ã¶deme/iade gerekebilir

---

## ğŸ“Š 9. KOÅULLAR HÄ°YERARÅÄ°SÄ° (Conditions)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      RailEurope data for all products                       â”‚
â”‚   Conditions described here will be applicable to all RailEurope products   â”‚
â”‚                        (passes, PTP, all carriers...)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                        Passes product range                            â”‚  â”‚
â”‚  â”‚     Conditions applicable to all passes, whatever the supplier.        â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚                     Supplier conditions                          â”‚  â”‚  â”‚
â”‚  â”‚  â”‚   Conditions applied to all marketing carriers of this supplier  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚        (e.g. SNCF supplier â†’ TGV, TER, IntercitÃ©, etc.)         â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚               Marketing carrier conditions                 â”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚    Conditions applied to all products of the carrier       â”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚   Pass product     â”‚  â”‚   Card product     â”‚           â”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚    conditions      â”‚  â”‚    conditions      â”‚           â”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚                    â”‚  â”‚                    â”‚           â”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ Applied only to    â”‚  â”‚ Displayed as info  â”‚           â”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ this specific      â”‚  â”‚ related to the     â”‚           â”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ product            â”‚  â”‚ card option        â”‚           â”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Pax type conditionsâ”‚  (AyrÄ± - Booking'deki yolcu tipine gÃ¶re)
â”‚                     â”‚
â”‚ Conditions displayedâ”‚
â”‚ on offer if such a  â”‚
â”‚ passenger type in   â”‚
â”‚ the booking         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### KoÅŸul HiyerarÅŸisi (YukarÄ±dan AÅŸaÄŸÄ±ya)
1. **RailEurope Global** â†’ TÃ¼m Ã¼rÃ¼nlere uygulanÄ±r
2. **Passes Range** â†’ TÃ¼m pass'lara uygulanÄ±r
3. **Supplier** â†’ O tedarikÃ§inin tÃ¼m taÅŸÄ±yÄ±cÄ±larÄ±na (SNCF â†’ TGV, TER, etc.)
4. **Marketing Carrier** â†’ O taÅŸÄ±yÄ±cÄ±nÄ±n tÃ¼m Ã¼rÃ¼nlerine
5. **Product Specific** â†’ Sadece o Ã¼rÃ¼ne
6. **Pax Type** â†’ Yolcu tipine gÃ¶re (Ã§ocuk, yetiÅŸkin, vs.)

---

## ğŸ”§ BACKEND SERVÄ°S MÄ°MARÄ°SÄ° (GÃ¼ncellenmiÅŸ)

```typescript
// era/services/era-booking.service.ts

export class EraBookingService {
  
  // 1. Booking oluÅŸtur
  async createBooking(offerLocations: string[]): Promise<Booking>
  
  // 2. Yolcu bilgilerini gÃ¼ncelle (her item iÃ§in)
  async updateTravelers(bookingId: string, itemId: string, travelers: Traveler[]): Promise<Booking>
  
  // 3. (Opsiyonel) Acente bilgisi
  async updateAgencyDetails(bookingId: string, agency: AgencyDetails): Promise<Booking>
  
  // 4. (Opsiyonel) Ek hizmetler
  async updateServices(bookingId: string, services: Service[]): Promise<Booking>
  
  // 5. Ã–n rezervasyon
  async prebook(bookingId: string): Promise<Booking>
  
  // 6. (Opsiyonel) Fatura belgeleri
  async claimBillingDocs(bookingId: string): Promise<BillingDocs>
  
  // 7a. Onaylama
  async confirmBooking(bookingId: string): Promise<Booking>
  
  // 7b. (Alternatif) Bekletme
  async holdBooking(bookingId: string): Promise<Booking>
  
  // 8. Bilet yazdÄ±rma
  async printTicket(bookingId: string): Promise<Ticket>
  
  // Silme
  async deleteItem(bookingId: string, itemId: string): Promise<void>
}

// era/services/era-refund.service.ts
export class EraRefundService {
  async getQuotation(bookingId: string, items: string[]): Promise<RefundQuotation>
  async confirmRefund(bookingId: string, quotationId: string): Promise<Refund>
}

// era/services/era-exchange.service.ts  
export class EraExchangeService {
  async searchExchangeOffers(bookingId: string, newSearch: SearchRequest): Promise<ExchangeOffers>
  async getQuotation(bookingId: string, newOfferId: string): Promise<ExchangeQuotation>
  async confirmExchange(bookingId: string, quotationId: string): Promise<Exchange>
}
```

---

## ğŸ“‹ API ENDPOINT Ã–ZET TABLOSU

| Kategori | Method | Endpoint | AÃ§Ä±klama |
|----------|--------|----------|----------|
| **Auth** | POST | `/oauth2/token` | Token al (60 dk) |
| **Places** | GET | `/places/autocomplete` | Ä°stasyon ara |
| **Places** | GET | `/places` | TÃ¼m istasyonlar |
| **Search** | POST | `/offers/point-to-point/searches` | Sefer ara |
| **Search** | POST | `/offers/point-to-point/searches/{id}?page=next` | Sonraki sayfĞ° |
| **Booking** | POST | `/bookings` | Booking oluÅŸtur |
| **Booking** | GET | `/bookings/{id}` | Booking getir |
| **Booking** | PUT | `/bookings/{id}/items/{itemId}/travelers` | Yolcu gÃ¼ncelle |
| **Booking** | DELETE | `/bookings/{id}/items/{itemId}` | Item sil |
| **Checkout** | POST | `/bookings/{id}/checkout/prebook` | Ã–n rezervasyon |
| **Checkout** | POST | `/bookings/{id}/checkout/confirm` | Onaylama |
| **Checkout** | POST | `/bookings/{id}/checkout/hold` | Bekletme |
| **Ticket** | POST | `/bookings/{id}/print` | Bilet yazdÄ±r |
| **Refund** | POST | `/bookings/{id}/refunds/quotation` | Ä°ade teklifi |
| **Refund** | POST | `/bookings/{id}/refunds/confirm` | Ä°ade onayla |
| **Exchange** | POST | `/bookings/{id}/exchanges/search` | DeÄŸiÅŸiklik ara |
| **Exchange** | POST | `/bookings/{id}/exchanges/quotation` | DeÄŸiÅŸiklik teklifi |
| **Exchange** | POST | `/bookings/{id}/exchanges/confirm` | DeÄŸiÅŸiklik onayla |

---

## âš ï¸ KRÄ°TÄ°K NOTLAR

### Status GeÃ§iÅŸleri
```
(yok) â†’ CREATED â†’ PREBOOKED â†’ INVOICED â†’ (REFUNDED/EXCHANGED)
```

### Silme KurallarÄ±
- âœ… CREATED veya PREBOOKED â†’ silinebilir
- âŒ INVOICED â†’ silinemez (refund kullan)
- âŒ Tek item kaldÄ±ysa â†’ silinemez

### Token YÃ¶netimi
- â±ï¸ 60 dakika geÃ§erli
- ğŸ”„ Expire'dan Ã¶nce yenile
- ğŸ’¾ Cache'le

---

**Bu dokÃ¼man ERA API resmi diyagramlarÄ±ndan oluÅŸturulmuÅŸtur.**
